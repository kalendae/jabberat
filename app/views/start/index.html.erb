<style type="text/css">
  textarea#topic_content {
    border: solid 1px #999;
    height: 40px;
    width: 400px;
  }
  input#t {
    border: solid 1px #999;
    width: 400px;
    margin-left: 8px;
  }
  input[type=submit] {
    border: solid 1px #999;
    width: 58px;
    margin-left: 8px;
  }
  label {
    font-size: 12px;
    font-weight: bold;
    color: #666;
  }
  div#main_deal {
    margin-top: 80px;        
  }
  div#creation_prompt {
    margin-top: 10px;        
  }
  .topic_in_list {
    margin: 10px 10px 0px 10px;
    border: solid 1px #fff;
    padding: 5px;
    background-color: #f4f4f4;
  }
  .topic_owner_in_list {
    float: left;
    border: none;
  }
  .owner_pic_in_list {
    border: none;        
  }
  .topic_content_in_list {
    margin-left: 35px;
    font-size: 12px;
    font-family: arial, helvetica, sans-serif;
  }
  .topic_content_link_in_list {
    text-decoration: none;
    color: #507090; 
  }
  .topic_time_in_list {
    font-size: 11px;
    color: #aaa;
    margin-left: 35px;
  }
  div#existing_suggestions {
    width: 70%;
    margin-left: auto;
    margin-right: auto;
    text-align: left;
  }
  div#exist_prompt {
    margin: 10px;
  }
  div#topic_area {
          margin-top: 50px;
          margin-left: auto;
          margin-right: auto;
          width: 90%;
          }
  div#the_topic {
      border-top: solid 8px #c0c0e0;
      padding: 5px;
      background-color: #f4f4ff;
      text-align: left;
      min-height:80px; 
      height:auto;
  }
  .comment {
          border-top: solid 6px #c0c0e0;
          padding: 5px;
          background-color: #f4f4ff;
          text-align: left;
          min-height:40px; 
          height:auto;
          margin-top: 10px;
          width: 60%;
          }
  .owner_pic, .comment_owner_pic {
      border: solid 1px #fff;
      float: left;
  }
  .topic_content {
      margin-left: 70px;
      font-family: arial, helvetica, sans-serif;
      font-size: 18px;
      color: #000;
  }
  .comment_content {
          margin-left: 50px;
          font-family: verdana, sans-serif;
          font-size: 12px;
          color: #000;
          }
  .topic_time {
          font-size: 13px;
          color: #666;
          margin-left: 70px;
  }
  .comment_time {
          font-size: 11px;
          color: #bbb;
          margin-left: 50px;
          }
  .topic_owner_name {
          font-size: 16px;
          color: #aaa;
          margin-left: 70px;
          }
  .comment_text_area {
          width: 100%;
          height: 70px;
          border: solid 1px #99c;
          }
  div#topic_reply {
          width: 60%;
          text-align: left;
          margin-top: 10px;
          margin-left: 2%;
          }
  .reply_to {
          font-size: 13px;
          color: #aaa;
          }
  .comment_submit {
          color: #fff;
          border: solid 1px #449 !important;
          background-color: #99E;
          margin-left: 0px !important;
          font-size: 11px;
          }
  .comment_owner_link {
          text-decoration: none;
          color: #6090aa;
          }
</style>

<div id="pullout">
  <div id="logo">Jabber@t</div>
  <div id="topic_space">
      <div class="medium_heading">
          Hot Topics
      </div>
      <% @hot_topics.each do |topic| %>
          <div class="topic_in_list">
              <%= link_to(image_tag(gravatar_url_for(topic.user), :width => 30, :height => 30, :class => 'owner_pic_in_list'),topic.user, :class => 'topic_owner_in_list') %>
              <div class="topic_content_in_list">
                <a href="<%= url_for(:controller => :start, :action => :index, :id => topic) %>" class="topic_content_link_in_list">
                      <%= topic.content %>
                </a>
              </div>
              <div class="topic_time_in_list">
                  <%= time_ago_in_words(topic.updated_at) %> ago
              </div>
          </div>
      <% end %>
  </div>
</div>

<div id="main_space">

    <% if flash[:notice] -%>
        <p class="notice"><%= flash[:notice] %></p>
    <% end -%>
    <% if flash[:error] -%>
        <p class="error"><%= flash[:error] %></p>
    <% end -%>

    <% form_tag '', :method => 'get' do -%>
        <div id="main_deal">
            <label>Jabber About:</label>
            <%= text_field_tag :t, @content %>
            <%= submit_tag "Go", :name => 'c' %>
        </div>
    <% end %>
    <% unless @content.blank? %>
      <% unless @topics.blank? %>
        <div id="exist_prompt">Does your topic already exist?</div>
        <div id="existing_suggestions">
            <% @topics.each do |topic| %>
                <div class="topic_in_list">
                    <%= link_to(image_tag(gravatar_url_for(topic.user), :width => 30, :height => 30, :class => 'owner_pic_in_list'),topic.user, :class => 'topic_owner_in_list') %>
                    <div class="topic_content_in_list">
                      <a href="<%= url_for(:controller => :start, :action => :index, :id => topic) %>" class="topic_content_link_in_list">
                            <%= topic.content %>
                      </a>
                    </div>
                    <div class="topic_time_in_list">
                        <%= time_ago_in_words(topic.updated_at) %> ago
                    </div>
                </div>
            <% end %>
        </div>
      <% end %>
      <div id="creation_prompt">
          <% form_for(@topic) do |f| %>
              <%= f.hidden_field :content, :value => @content %>
              <%= f.submit "Create a new Topic", :style => "width:138px;" %>
          <% end %>
      </div>
    <% end %>
    
    <% if @content.blank? and !@topic.id.blank? %>
      <div id="topic_area">
        <div id="the_topic">
            <%= link_to(image_tag(gravatar_url_for(@topic.user), :width => 60, :height => 60, :class => 'owner_pic'),@topic.user, :class => 'topic_owner') %>
            <div class="topic_owner_name">
                <%= link_to "#{@topic.user.login}:", @topic.user %>
            </div>
            <div class="topic_content">
              <%= @topic.content %>
            </div>
            <div class="topic_time">
                <%= time_ago_in_words(@topic.updated_at) %> ago
            </div>

        </div>
        <div id="topic_reply">
            <div class="reply_to">
                Your reply to <%= image_tag(gravatar_url_for(@topic.user), :width => 15, :height => 15) %> <%= @topic.user.login %>
            </div>
            <% form_for([@topic,@comment]) do |f| %>
              <%= f.text_area :content, :class => "comment_text_area" %>
              <%= f.submit "Submit", :class => "comment_submit" %>
            <% end %>
        </div>
        <% @comments.each do |comment| %>
          <div class="comment" style="margin-left:2%;">
              <%= link_to(image_tag(gravatar_url_for(comment.user), :width => 35, :height => 35, :class => 'comment_owner_pic'),comment.user, :class => 'comment_owner') %>
              <div class="comment_content">
                <%= link_to "#{comment.user.login}:", comment.user, :class => "comment_owner_link" %> <%= comment.content %>
              </div>
              <div class="comment_time">
                  <%= time_ago_in_words(comment.created_at) %> ago
              </div>
          </div>
        <% end %>
      </div>
    <% end %>
</div>
